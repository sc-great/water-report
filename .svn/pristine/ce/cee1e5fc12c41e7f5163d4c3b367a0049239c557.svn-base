<!doctype html>
<html class="no-js" lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<title>中国水环境集团</title>
<th:block th:include="app/pages/homeHeader.html" />
</head>
<style>
.content-right {
	text-align: left;
	margin-left: 5%;
	width: 20%;
}
.font-size-13 {
	font-size: 1.3rem;
}
.table_edicine .meiyihang_title {
    color: #fff;
}
.meiyihang_content {
	font-size: 1.3rem;
}
</style>
<body>
<div class="main">
	<div class="home_top" style="height: 36%;">
		<div class="menu_table">
			<div class="menu_row">
				<a class="menu_cell" th:href="${'/app/waterQualityArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/sz.png}">
						</div>
					</div>
					<div class="menu_name">水质统计</div>
				</a>
				<a class="menu_cell" th:href="${'/app/waterYieldArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/sl.png}">
						</div>
					</div>
					<div class="menu_name">水量统计</div>
				</a>
				<a class="menu_cell" th:href="${'/app/electricQuantityArea'}">
					<div class="img-table">
						<div class="img-cel img_w">
							<img th:src="@{/webapp/image/dh.png}">
						</div>
					</div>
					<div class="menu_name">电耗统计</div>
				</a>
				<a class="menu_cell" th:href="${'/app/medicationArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/yh.png}">
						</div>
					</div>
					<div class="menu_name">药耗统计</div>
				</a>
			</div>
			<div class="menu_row">
				<a class="menu_cell" th:href="${'/app/sludgeArea'}">
					<div class="img-table">
						<div class="img-cel img_w">
							<img th:src="@{/webapp/image/wn.png}">
						</div>
					</div>
					<div class="menu_name">污泥统计</div>
				</a>
				<a class="menu_cell" th:href="${'/app/testWaterArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/hy.png}">
						</div>
					</div>
					<div class="menu_name">化验数据</div>
				</a>
				<a class="menu_cell" th:href="${'/app/beOnDutyArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/zb.png}">
						</div>
					</div>
					<div class="menu_name">值班统计</div>
				</a>
				<a class="menu_cell" th:href="${'/app/comprehensiveArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/zhtj.png}">
						</div>
					</div>
					<div class="menu_name">综合统计</div>
				</a>
			</div>
			<div class="menu_row">
				<a class="menu_cell"
					th:onclick="costInfoDifferentOrg([[${currEableFlag}]]);">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/sf.png}">
						</div>
					</div>
					<div class="menu_name">收费情况</div>
				</a>
				<a class="menu_cell" th:href="${'/app/mandatoryCheckArea'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/qzjc.png}">
						</div>
					</div>
					<div class="menu_name">强制检测</div>
				</a>
				<a class="menu_cell" th:href="${'/app/consumable'}">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/bpbj.png}">
						</div>
					</div>
					<div class="menu_name">备品备件</div>
				</a>
				<a class="menu_cell" th:onclick="companys([[${currEableFlag}]]);">
					<div class="img-table">
						<div class="img-cel">
							<img th:src="@{/webapp/image/scxx.png}">
						</div>
					</div>
					<div class="menu_name">水厂信息</div>
				</a>
			</div>
		</div>
	</div>
	<div class="home_main">
		<div class="ibox" style="border-color: #1590ee;" onclick="twoDeail()">
			<a class="ibox-title" th:href="${'/app/waterQualityNotPass'}">
				<div class="icon">
					<img th:src="@{/webapp/image/icon-yynl.png}">
				</div>
				<div class="text">运营能力</div>
			</a>
			<div class="ibox-content danhang" style="margin-top: 0;">
				<div class="row" style="margin-top: 1vh;">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 45%;">设计处理能力累计</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 40%;">
						<span class="color-1" th:text="${factoryTon!=null?factoryTon:'0'}"></span>
					</div>
				</div>
				<div class="row" style="margin-top: 1vh;">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 45%;">实际处理累计</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 40%;">
						<span class="color-1" th:text="${waterYieldOutSum!=null?waterYieldOutSum:'0'}"></span>
					</div>
				</div>
				<div class="row" style="margin-top: 1vh;margin-bottom: 2vh;">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 45%;">达标率</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 40%;">
						<span class="color-1" th:text="${reachRate!=null?reachRate+'%':''}"></span>
					</div>
				</div>
			</div>
		</div>
		<div class="ibox" style="border-color: #ff7e00;" id="money_div" hidden="hidden">
			<a class="ibox-title" th:onclick="costInfoDifferentOrg([[${currEableFlag}]]);">
				<div class="icon">
					<img th:src="@{/webapp/image/icon-sfjz.png}">
				</div>
				<div class="text">收费情况</div>
			</a>
			<div class="ibox-content danhang" style="margin-top: 0;">
				<div class="row" style="margin-top: 1vh;">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 45%;">当年收费目标</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 40%;">
						<span class="color-1" th:text="${costSpeedA2!=null?costSpeedA2+'':''}"></span>
					</div>
				</div>
				<div class="row" style="margin-top: 1vh;">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 45%;">当年实际收费</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 40%;">
						<span class="color-1" th:text="${costspeedA1!=null?costspeedA1+'':''}"></span>
					</div>
				</div>
				<div class="row" style="margin-top: 1vh; margin-bottom: 2vh;">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 45%;">收费进展</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 40%;">
						<span class="color-1" th:text="${costspeed!=null?costspeed+'%':''}"></span>
					</div>
				</div>
			</div>
		</div>
		<div class="ibox" style="border-color: #1590ee;">
			<a class="ibox-title" th:href="${'/app/beOnDutyArea'}">
				<div class="icon">
					<img th:src="@{/webapp/image/icon-zb.png}">
				</div>
				<div class="text">当日值班统计</div>
			</a>
			<div class="ibox-content" style="margin-top: 0;">
				<div class="row">
					<div class="cel cel-2 font-size-15" style="text-align: left; margin-left: 10%; width: 10%;">到岗</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 30%;">
						<span class="color-1" th:text="${(workerCount!=null?workerCount:'0')+'/'+(workerTotal!=null?workerTotal:'0')}"></span>
						<span class="color-2" style="font-weight: 400;"
								th:text="${((workerCount!=null && workerTotal!=null && workerTotal>0)?#numbers.formatDecimal((workerCount*100.0/workerTotal),0,1):'0')+'%'}"></span>
					</div>
					<div class="cel cel-2 font-size-15 content-right" style="">现场/远程</div>
					<div class="cel cel-3 font-size-15 bold" style="width: 25%;">
						<span class="color-1"
								th:text="${(sceneWorkerCount!=null?sceneWorkerCount:'0')+'/'+(onlineWorkerCount!=null?onlineWorkerCount:'0')}"></span>
					</div>
				</div>
			</div>
		</div>
		<div class="ibox" style="border-color: #ff7e00;">
			<a class="ibox-title" th:href="${'/app/waterYieldArea'}">
				<div class="icon">
					<img th:src="@{/webapp/image/icon-sl.png}">
				</div>
				<div class="text">水量统计</div>
				<div class="tips">
					<div class="legend">
						<span class="bg-color2"></span>进水
					</div>
					<div class="legend">
						<span class="bg-color1"></span>出水
					</div>
				</div>
			</a>
			<div class="ibox-content">
				<div class="row">
					<div class="cel cel-3 font-size-15 content-right" style="line-height: 6vh; text-align: left; margin-left: 10%; width: 20%;">当日水量</div>
					<div class="cel cel-2 font-size-14 bold" style="line-height: 3vh; width: 20%;">
						<div class="color-2" style="margin-bottom: 5px;"
								th:text="${(sumWaterYield?.totalTodayIn!=null?sumWaterYield?.totalTodayIn:'0')+''}"></div>
						<div class="color-1"
								th:text="${(sumWaterYield?.totalTodayOut!=null?sumWaterYield?.totalTodayOut:'0')+''}"></div>
					</div>
					<div class="cel cel-2 font-size-15 content-right" style="line-height: 6vh">累计水量</div>
					<div class="cel cel-3 font-size-14 bold" style="line-height: 3vh; width: 25%;">
						<div class="color-2" style="margin-bottom: 5px;"
								th:text="${(sumWaterYield?.totalIn!=null?sumWaterYield?.totalIn:'0')+''}"></div>
						<div class="color-1"
								th:text="${(sumWaterYield?.totalOut!=null?sumWaterYield?.totalOut:'0')+''}"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="ibox" style="border-color: #1590ee;">
			<a class="ibox-title" th:href="${'/app/electricQuantityArea'}">
				<div class="icon icon_w">
					<img th:src="@{/webapp/image/icon-dh.png}">
				</div>
				<div class="text">电耗统计</div>
				<div class="tips">
					<div class="legend">
						<span class="bg-color2"></span>当日
					</div>
					<div class="legend">
						<span class="bg-color1"></span>累计
					</div>
				</div>
			</a>
			<div class="ibox-content">
				<div class="row">
					<div class="cel cel-2 font-size-15" style="line-height: 6vh; text-align: left; margin-left: 10%; width: 20%;">水厂电耗</div>
					<div class="cel cel-3 font-size-14 bold" style="line-height: 3vh; width: 20%;">
						<div class="color-2" style="margin-bottom: 5px;" th:text="${sumElectricity?.totalTodayElectricity}"></div>
						<div class="color-1" th:text="${sumElectricity?.totalTotalElectricity}"></div>
					</div>
					<div class="cel cel-2 font-size-15 content-right" style="line-height: 6vh">泵站电耗</div>
					<div class="cel cel-3 font-size-14 bold" style="line-height: 3vh; width: 25%;">
						<div class="color-2" style="margin-bottom: 5px;" th:text="${sumElectricity?.totalPumpTodayEletricity}"></div>
						<div class="color-1" th:text="${sumElectricity?.totalPumpTotalEletricity}"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="ibox" style="border-color: #ff7e00;">
			<a class="ibox-title" th:href="${'/app/medicationArea'}">
				<div class="icon icon_w">
					<img th:src="@{/webapp/image/icon-yh.png}">
				</div>
				<div class="text">药量统计</div>
				<div class="tips">
					<div class="legend">
						<span class="bg-color2"></span>当日
					</div>
					<div class="legend">
						<span class="bg-color1"></span>累计
					</div>
				</div>
			</a>
			<div class="ibox-content center table_edicine">
				<div class="row border-bottom font-size-15 meiyihang_title">
					<div class="cel cel-2">PAC</div>
					<div class="cel cel-3">PAM阴离子</div>
					<div class="cel cel-3">PAM阳离子</div>
					<div class="cel cel-2">葡萄糖</div>
				</div>
				<div class="row meiyihang_content">
					<div class="cel cel-2 font-size-14 bold">
						<div class="color-2" th:text="${sumMedicine?.sumTodayPAC}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalPAC}"></div>
					</div>
					<div class="cel cel-3 font-size-14 bold youbeijing">
						<div class="color-2" th:text="${sumMedicine?.sumTodayPAMYin}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalPAMYin}"></div>
					</div>
					<div class="cel cel-3 font-size-14 bold">
						<div class="color-2" th:text="${sumMedicine?.sumTodayPAMYang}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalPAMYang}"></div>
					</div>
					<div class="cel cel-2 font-size-14 bold youbeijing">
						<div class="color-2" th:text="${sumMedicine?.sumTodayGlucose}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalGlucose}"></div>
					</div>
				</div>
				<div class="row border-bottom font-size-15 meiyihang_title">
					<div class="cel cel-2">NaCLO</div>
					<div class="cel cel-3">复核除磷剂</div>
					<div class="cel cel-3">石灰</div>
					<div class="cel cel-2">葡萄糖</div>
				</div>
				<div class="row meiyihang_content">
					<div class="cel cel-2 font-size-14 bold">
						<div class="color-2" th:text="${sumMedicine?.sumTodayNaCLO}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalNaCLO}"></div>
					</div>
					<div class="cel cel-3 font-size-14 bold youbeijing">
						<div class="color-2" th:text="${sumMedicine?.sumTodayPhosphorus}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalPhosphorus}"></div>
					</div>
					<div class="cel cel-3 font-size-14 bold">
						<div class="color-2" th:text="${sumMedicine?.sumTodayLime}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTodayLime}"></div>
					</div>
					<div class="cel cel-2 font-size-14 bold youbeijing">
						<div class="color-2" th:text="${sumMedicine?.sumTodayGlucose}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalGlucose}"></div>
					</div>

				</div>
				<div class="row border-bottom font-size-15 meiyihang_title">
					<div class="cel cel-2">氯酸钠</div>
					<div class="cel cel-3">乙酸钠</div>
				</div>
				<div class="row meiyihang_content">
					<div class="cel cel-2 font-size-14 bold">
						<div class="color-2" th:text="${sumMedicine?.sumTodaySC}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalSC}"></div>
					</div>
					<div class="cel cel-3 font-size-14 bold youbeijing">
						<div class="color-2" th:text="${sumMedicine?.sumTodaySA}"></div>
						<div class="color-1" th:text="${sumMedicine?.sumTotalSA}"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<input type="hidden" th:value="${orgType}" id="user_orgType" />
<style>
#topWindow {
	width: 100%;
	height: auto;
	position: fixed;
    bottom: 0;
}
#topPanel {
	width: 100%;
    height: 30vh;
    margin: 0 auto;
    background: #fff;
    box-shadow: darkgrey 10px 10px 30px 5px;
}
#topPanel .title {
	font-size: 1.4rem;
    font-weight: bold;
    line-height: 7vh;
    padding-left: 1vw;
}
#topPanel .title .icon {
	float: left;
}
#topPanel .title .icon {
	height: 100%;
    width: 10vw;
    text-align: center;
}
#topPanel .title .icon img {
	width: 5vw;
    height: auto;
    vertical-align: middle;
}
#topPanel .title .text {
	float: left;
}
#alarmInfoList li {
	font-size: 1.4rem;
	line-height: 5vh;
	height: 5vh;
    padding-left: 3vw;
}
#alarmInfoList li p {
	float: left;
	overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}
#alarmInfoList li span {
	float: right;
    margin-right: 3vw;
}
#alarmInfo_orgName {
	width: 38%;
}
#alarmInfo_alarminfo {
	margin-left: 2%;
	width: 22%;
}
#alarmInfo_alarmType {
	margin-left: 2%;
	width: 14%;
	color: #f17900;
}
#topwindowsContent {
	height: 66%;
    overflow-y: scroll;
    width: 100%;
}
#topwindowsContent li:hover {
	color: #3c8dbc;
}
#animateButton {
	height: 7vh;
    width: 100%;
    font-size: 4rem;
    text-align: center;
}
#animateButton img {
    width: 8%;
	height: auto;
	vertical-align: top;
}
#alarmButton {
	width: 12vw;
	height: 12vw;
	position: fixed;
    bottom: 5vw;
    right: 5vw;
}
#alarmButton img {
	width: 12vw;
    height: auto;
}
#alarmCount {
	display: inline-block;
    position: fixed;
    bottom: 5vw;
    right: 5vw;
    width: 12vw;
    line-height: 12vw;
    text-align: center;
    font-size: 2rem;
    color: #fff;
}
</style>
<div id="alarmButton" hidden="hidden" onClick="animateFunction()"><img th:src="@{/webapp/image/app-bgButton.png}"><span id="alarmCount">50</span></div>
<div id="topWindow" hidden="hidden">
	<div id="animateButton" onClick="animateFunction()"><p><img th:src="@{/webapp/image/app-bgU.png}"></p></div>
	<div id="topPanel">
		<div class="title">
			<div class="icon">
				<img th:src="@{/webapp/image/icon-bg.png}">
			</div>
			<div class="text">报警信息</div>
		</div>
		<div id="topwindowsContent">
			<ul id="alarmInfoList"></ul>
		</div>
	</div>
</div>
<script type="text/javascript">
var topPanel_isShow = true;
function animateFunction() {
	$("#topWindow").slideToggle("slow", function() {
		if (topPanel_isShow) {
			topPanel_isShow = false;
			$("#animateButton img").attr("src", "/webapp/image/app-bgU.png");
			$("#alarmButton").fadeIn("slow");
		} else {
			topPanel_isShow = true;
			$("#animateButton img").attr("src", "/webapp/image/app-bgD.png");
			$("#alarmButton").fadeOut("slow");
		}
	});
}
</script>
<script type="text/javascript">
// 数据来源
$(function() {
	$.post("/app/alarmInfo/list", function(data) {
		if (data.code != 0) {
			$("#topWindow").hide();
			$("#alarmButton").hide();
			return;
		}
			
		if (data.data == null || data.data == undefined || data.data.length <= 0) {
			$("#topWindow").hide();
			$("#alarmButton").hide();
			return;
		}
		$("#topWindow").show();
		$("#alarmInfoList").html("");
		$("#alarmCount").html(data.data.length);
		$("#alarmButton").fadeIn("slow");
		for (var i = 0; i < data.data.length; i ++) {
			var info = data.data[i];
			var type = info.alarmType;
			if (type == "1")
				type = "低库存";
			if (type == "2")
				type = "待检测";
			if (type == "3")
				type = "不达标";
			
			var bg = "";
			if (i % 2 != 1) {
				bg = 'style="background: #f6fbff;"';
			}
			
			var f_arr = info.fillDate.split("-");
			
			var li = '<li ' + bg + '>' +
				'		  <p id="alarmInfo_orgName" title="' + info.orgName + '">' + info.orgName + '</p>' +
				'		  <p id="alarmInfo_alarminfo" title="' + info.alarmItem + '">' + info.alarmItem + '</p>' +
				'		  <p id="alarmInfo_alarmType">' + type + '</p>' +
				'		  <span id="alarmInfo_fillDate" title="' + info.fillDate + '">' + f_arr[1] + '月' + f_arr[2] + '日</span>' +
				'	  </li>';
			$("#alarmInfoList").append(li);
		}
		$("#topWindow").hide();
		topPanel_isShow = false;
	})
})
// 页面跳转
/* function alarmInfoToObjPage(type, objId, orgId) {
	// 备品备件
	if (type == "1") {
		window.location = "/admin/materialControl/consumable?id=" + objId;
	}
	// 强制检测
	if (type == "2") {
		window.location = "/admin/materialControl/mandatoryCheckInfo?id=" + objId;
	}
	// 水质信息
	if (type == "3") {
		$.get("/admin/system/org/get/" + orgId, function(data) {
			if (data.code != 0) {
				$.modal.msgWarning(data.msg);
				return;
			}
			// 污水厂
			if (data.data.factoryType == "1") {
				window.location = "/admin/report/badWaterQualityInfo?id=" + objId;
			}
			// 供水厂
			if (data.data.factoryType == "2") {
				window.location = "/admin/report/goodWaterHealthInfo?id=" + objId;
			}
		})
	}
} */
</script>
</body>
<script>
$(function () {
   	if ($("#user_orgType").val() != "3") // 不是水厂用户
    	$("#money_div").show();
});

function companys(type) {
    if (type == "1") {
        window.location.href = '/app/addFactory';
    } else { //非水厂领导：集团、区域、水厂职员都可以看,集团区域看所管理范围内的水厂，职工只能看自己所在的水厂信息
        window.location.href = '/app/factoryArea';
    }
}

function costInfoDifferentOrg(type) {
	if (type == "1") {
		layer.open({
            content: "对不起，该栏目您没有查看权限！",
            btn: '知道了'
       });
    } else {
        window.location.href = '/app/costInfo';
   }
}
function twoDeail(){
	window.location.href = '/app/waterQualityNotPass';
}
</script>
</html>